ros_distro: humble
ros_domain_id: 42
registry: 192.168.56.10:5000
image_prefix: test_cross_arch

enable_apt_caching: true
enable_dds_router: true
discovery_server: 192.168.56.10

hosts:
  - name: amd64_host
    ip: 192.168.56.10
    user: vagrant
    arch: amd64
    manager: true

  - name: arm64_host
    ip: 192.168.56.20
    user: vagrant
    arch: arm64

components:
  # Heavy computation on x86_64
  - name: perception_processor
    sources:
      - packages/camera_driver
      - packages/image_processor
      - packages/object_detection
    runs_on: amd64_host
    entrypoint: ros2 launch perception_processor main.launch.py
    apt_packages:
      - libopencv-dev
      - python3-opencv

  # Edge controller on ARM64
  - name: edge_controller
    source: packages/motor_controller
    runs_on: arm64_host
    entrypoint: ros2 run motor_controller controller
    devices:
      - "/dev/ttyACM0:/dev/ttyACM0"
    apt_packages:
      - python3-serial

  # Communication bridge
  - name: data_bridge
    repositories:
      - url: https://github.com/ros2/rosbag2.git
        version: humble
        folder: rosbag2
    runs_on: amd64_host
    entrypoint: ros2 run data_bridge bridge_node